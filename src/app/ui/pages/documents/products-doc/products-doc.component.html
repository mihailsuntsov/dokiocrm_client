<mat-drawer-container  [ngClass]="{doc_container: mode=='standart',doc_container_select_mode: mode!='standart'}" autosize>
    <mat-drawer #drawer class="categories-sidenav" mode="side" opened>
        <div class="category-toolbar-search flex">
            <span style="flex-grow: 1;"></span>
                <div>

                </div>
            <span style="flex-grow: 1;"></span>
        </div>
        
        <div class="category-toolbar-icons flex">
            <span style="flex-grow: 1;"></span>
                <div>
                        <button mat-icon-button (click)="expandAllCheckedNodes(); categoriesExpanded=true;"  
                        matTooltip="Показать все категории, содержащие данный товар" color="primary">
                            <mat-icon>visibility</mat-icon>
                        </button>
                        <button mat-icon-button (click)="collapseAllNodes(); categoriesExpanded=false;" 
                            matTooltip="Свернуть все категории" color="primary">
                                <mat-icon>visibility_off</mat-icon>
                        </button>
                        <button mat-icon-button 
                            [disabled]="!(+selectedProductCategory.selectedNodeId>0)"
                            (click)="
                            addCheckbox(selectedProductCategory.selectedNodeId);
                            selectCheckboxesOfAllParents(getNodeById(selectedProductCategory.selectedNodeId)); 
                            categoriesExpanded=false;" 
                            matTooltip="Выбрать все категории данной ветви" color="primary">
                                <mat-icon>publish</mat-icon>
                        </button>
                </div>
            <span style="flex-grow: 1;"></span>
        </div>
        <mat-divider></mat-divider>

        <mat-tree [dataSource]="treeDataSource" [treeControl]="treeControl">
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>
                <button mat-icon-button disabled></button>
                <mat-checkbox style="margin-right:8px;"
                    (click)="$event.stopPropagation()"
                    (change)="$event ? clickTableCheckbox(node.id) : null"
                    [checked]="isSelectedCheckbox(node.id)"
                    >
                </mat-checkbox>
                <span class="node" [ngClass]="{selected_node:node.id==selectedProductCategory.selectedNodeId}" (click)="selectNode(node)">{{node.name}}</span>
            </mat-tree-node>
            <mat-tree-node *matTreeNodeDef="let node;when: hasChild" matTreeNodePadding>
                <button mat-icon-button matTreeNodeToggle
                        [attr.aria-label]="'toggle ' + node.name">
                <mat-icon class="mat-icon-rtl-mirror">
                    {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                </mat-icon>
                </button>
                <mat-checkbox style="margin-right:8px;"
                    (click)="$event.stopPropagation()"
                    (change)="$event ? clickTableCheckbox(node.id) : null"
                    [checked]="isSelectedCheckbox(node.id)"
                    >
                </mat-checkbox>
                <span class="node" [ngClass]="{selected_node:node.id==selectedProductCategory.selectedNodeId}" (click)="selectNode(node)">{{node.name}}</span>
                
            </mat-tree-node>
        </mat-tree>

    </mat-drawer>
    <div class="categories-sidenav-content">
        <mat-card class="card">
        
            <mat-card-title class="flex">
                <div class="card-name">Товары и услуги</div>
                        <button 
                            MatSnackBar="Создать новый документ"
                            mat-raised-button 
                            [style.display]="visAfterCreatingBlocks==true?'none':'block'"
                            (click)="clickBtnCreateNewDocument()" 
                            [disabled]="!formBaseInformation.valid" 
                            *ngIf="allowToCreate"
                            color="primary"
                            class="button">
                            <i class="material-icons">add_circle_outline</i> Создать
                        </button>
                        <!-- (click)="clickBtnUpdate()" -->
                        <button  
                                mat-raised-button 
                                matTooltip="Выбрать товар и закрыть окно"
                                [mat-dialog-close]="formBaseInformation.get('product_code_free').value" 
                                *ngIf="(mode=='createForAcceptance' || mode=='createForPosting') && (+id>0)"
                                color="primary">
                                <i class="material-icons">star</i>
                            <span> Выбрать</span>
                        </button>
                        <button 
                            matTooltip="Сохранть изменения"
                            mat-raised-button 
                            [style.display]="visBtnUpdate==true?'block':'none'"
                            (click)="clickBtnUpdate()"
                            [disabled]="!formBaseInformation.valid" 
                            color="primary"
                            class="button">
                            <i class="material-icons">done</i> Сохранить
                        </button>
                        <a routerLink="../../products">
                            <button 
                                matTooltip="Выйти из документа"
                                mat-raised-button
                                *ngIf="mode=='standart'" 
                                color="accent"
                                class="button">
                                <i class="material-icons">close</i> {{id>0?'Выйти':'Отмена'}}
                            </button>
                        </a>
                        <button 
                                matTooltip="Закрыть окно"
                                mat-raised-button 
                                *ngIf="mode!='standart'"
                                color="accent"
                                (click)="onNoClick()"
                                class="button">
                                <i class="material-icons">close</i> Отмена
                        </button>
                        
            </mat-card-title>
            <mat-card-subtitle [ngClass]="{invisible: visBeforeCreatingBlocks}">Предприятие: {{formBaseInformation.get('company').value}}</mat-card-subtitle>
            <mat-card-content> 

                <form  class="form-horizontal" id="formControl" method="post" action="" style="margin-bottom: 0px;">
                        <div class="form-group" style="display: none;">
                            <label class="control-label col-sm-2" for="SortColumn">SelectedNodeId</label>
                            <input [(ngModel)]="selectedProductCategory.selectedNodeId" type="text" class="form-control" id="SelectedNodeId" name="SelectedNodeId" value="">
                        </div>
                        <div class="form-group" style="display: none;">
                            <label class="control-label col-sm-2" for="SortColumn">SelectedNodeName</label>
                            <input [(ngModel)]="selectedProductCategory.selectedNodeName" type="text" class="form-control" id="SelectedNodeName" name="SelectedNodeName" value="">
                        </div>
                </form>

                <form [formGroup]="formBaseInformation">   

                        <mat-tab-group>

                                <mat-tab label="Информация">
                                        <div class="container-fluid">
                                            <div class="row" style="padding: 10px">
                                                
                                                <div class="col-lg-4  col-md-12">    
                                                    <!-- {{this.st_prefix_barcode_pieced}}--{{this.st_prefix_barcode_packed}} -->
                                                    <mat-card class="card-block">
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">Основная информация</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content class="input-form">

                                                            <mat-form-field style="display: none">
                                                                <input  matInput
                                                                        placeholder="id"
                                                                        formControlName="id"/>
                                                            </mat-form-field>
                                                            
                                                            <mat-form-field [ngClass]="{invisible: visAfterCreatingBlocks}" >
                                                                <mat-label>Предприятие</mat-label>
                                                                <mat-select  formControlName="company_id" 
                                                                (selectionChange)="
                                                                loadTrees(); 
                                                                formBaseInformation.get('product_code_free').setValue('');
                                                                product_code_free_isReadOnly=true">                          
                                                                    <mat-option  *ngFor="let rt of receivedCompaniesList" [value]="rt.id">
                                                                            {{rt.abbreviation}}{{rt.name}}
                                                                    </mat-option> 
                                                                </mat-select>
                                                            </mat-form-field>
                                                                <mat-form-field>
                                                                <input   matInput 
                                                                        placeholder="Наименование{{formBaseInformation.get('name').value==''?'*':''}}"
                                                                        #name
                                                                        maxlength="500"
                                                                        formControlName="name"/>
                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('name').touched && formBaseInformation.get('name').invalid">
                                                                    <i class="form-invalid">Поле не заполнено или заполнено неверно.</i>
                                                                </mat-hint>
                                                                <mat-hint align="end" *ngIf="name.value.length>400">{{name.value.length}} / 500</mat-hint>
                                                            </mat-form-field>
                                                            <mat-form-field>
                                                                <input   matInput
                                                                        placeholder="Описание"
                                                                        #description
                                                                        maxlength="2048"
                                                                        formControlName="description"/>
                                                                <mat-hint align="end" *ngIf="description.value.length>1000">{{description.value.length}} / 2048</mat-hint>
                                                            </mat-form-field>
                                                            <div class="flex">
                                                                <mat-form-field style="width:65%; margin-right:5px;">
                                                                    <mat-label>Признак предмета расчёта</mat-label>
                                                                    <mat-select  formControlName="ppr_id">                          
                                                                        <mat-option  *ngFor="let rt of spravSysPPRSet" [value]="rt.id">
                                                                                {{rt.name}}
                                                                        </mat-option> 
                                                                        
                                                                    </mat-select>
                                                                </mat-form-field>
                                                                <mat-form-field style="width:35%;">
                                                                    <mat-label>НДС</mat-label>
                                                                    <mat-select  formControlName="nds_id">                          
                                                                        <mat-option  *ngFor="let rt of spravSysNdsSet" [value]="rt.id">
                                                                                {{rt.name}}
                                                                        </mat-option> 
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="flex">
                                                                <mat-form-field style="width:50%; margin-right:5px;">
                                                                    <input   matInput
                                                                            placeholder="Артикул"
                                                                            #article
                                                                            maxlength="100"
                                                                            formControlName="article"/>
                                                                            <mat-hint align="end" *ngIf="article.value.length>80">{{article.value.length}} / 100</mat-hint>
                                                                </mat-form-field>
                                                                <mat-form-field style="width:50%;">
                                                                    <mat-label>Единица измерения{{formBaseInformation.get('edizm_id').value==''?'*':''}}</mat-label>
                                                                    <input matInput
                                                                    type="text"
                                                                    formControlName="edizm_name" 
                                                                    [matAutocomplete]="auto4"
                                                                    (input)="checkEmptyProductEdizmField();"
                                                                    (change)="checkEmptyProductEdizmField();">
                                                                    <mat-autocomplete #auto4="matAutocomplete">
                                                                    <mat-option *ngFor="let option of filteredSpravSysEdizmOfProductAll | async" [value]="option.name">
                                                                        <div (click)="formBaseInformation.get('edizm_id').setValue(option.id)">
                                                                            <span style="margin:10px;">{{option.name}}</span>
                                                                        </div>
                                                                    </mat-option>
                                                                    </mat-autocomplete>
                                                                    <mat-hint  align="start" *ngIf="formBaseInformation.get('edizm_name').touched && formBaseInformation.get('edizm_name').invalid">
                                                                        <i class="form-invalid">Поле не заполнено или заполнено неверно.</i>
                                                                    </mat-hint>
                                                                </mat-form-field>
                                                            </div>

                                                            <div class="flex">
                                                                <mat-form-field style="width:50%; margin-right:5px;" 
                                                                    >
                                                                    <mat-slide-toggle formControlName="not_sell">Снят с продаж</mat-slide-toggle>
                                                                    <input matInput hidden/>
                                                                </mat-form-field>
                                                            
                                                                <mat-form-field  style="width:50%;"
                                                                    >
                                                                    <mat-slide-toggle formControlName="indivisible">Неделимый</mat-slide-toggle>
                                                                    <input matInput hidden/>
                                                                </mat-form-field>
                                                            </div>



                                                            <div  [ngClass]="{invisible: visBeforeCreatingBlocks || (+formBaseInformation.get('ppr_id').value>2)}">
                                                                <div class="flex"  *ngIf="formBaseInformation.get('company_id').value">
                                                                    <mat-form-field style="width:65%; margin-right:5px;">
                                                                        <input matInput 
                                                                        placeholder="Группа товаров" 
                                                                        aria-label="State" 
                                                                        [matAutocomplete]="auto3" 
                                                                        [formControl]="searchProductGroupsCtrl"
                                                                        (input)="canAutocompleteQuery=true; checkEmptyProductGroupField();"
                                                                        (change)="canAutocompleteQuery=false; checkEmptyProductGroupField();">
                                                                        <mat-autocomplete #auto3="matAutocomplete">
                                                                        <ng-container *ngIf="!isProductGroupLoading" style="width:320px;">
                                                                            <mat-option style="padding:0px" *ngFor="let group of filteredProductGroups" [value]="group.name">
                                                                            <div (click)="onSelectProductGroup(group.id,group.name)">
                                                                                <span style="margin:10px;"><b>{{group.name}}</b> ({{group.description}})</span>
                                                                            </div>
                                                                            </mat-option>
                                                                        </ng-container>
                                                                        </mat-autocomplete>
                                                                    </mat-form-field>
                                                                    <mat-form-field 
                                                                        *ngIf="product_code_free_isReadOnly && (+formBaseInformation.get('company_id').value>0)" 
                                                                        style="width:35%">
                                                                        <input  matInput
                                                                                (click)="EditProductCodeFree()"
                                                                                placeholder="Код"
                                                                                formControlName="product_code_free"
                                                                                [readonly]=true/>
                                                                    </mat-form-field>
                                                                    <mat-form-field  
                                                                        *ngIf="!product_code_free_isReadOnly && (+formBaseInformation.get('company_id').value>0)"  
                                                                        style="width:50%">
                                                                        <input  matInput
                                                                                #codeFreeValue 
                                                                                maxlength="10"
                                                                                placeholder="Код"
                                                                                (keypress)="numberOnly($event)"
                                                                                (change)="checkProductCodeFreeUnical()"
                                                                                formControlName="product_code_free"/>
                                                                        <mat-hint  align="start" *ngIf="formBaseInformation.get('product_code_free').touched && formBaseInformation.get('product_code_free').invalid">
                                                                            <i *ngIf="formBaseInformation.get('product_code_free').errors.pattern" class="form-invalid">Код должен состоять из цифр</i>
                                                                        </mat-hint>
                                                                        <mat-hint align="end">{{codeFreeValue.value.length}} / 10</mat-hint>
                                                                        <mat-progress-bar *ngIf="isProductCodeFreeUnicalChecking" mode="indeterminate"></mat-progress-bar>
                                                                    </mat-form-field>
                                                                </div>
                                                                <mat-form-field  style="display: none;" >
                                                                    <input   matInput
                                                                            placeholder="Группа товаров ID"
                                                                            formControlName="productgroup_id"/>
                                                                </mat-form-field>
                                                                <mat-progress-bar *ngIf="isProductGroupLoading" mode="indeterminate"></mat-progress-bar>
                                                                
                                                                <mat-form-field  style="display: none;" >
                                                                    <input   matInput
                                                                            placeholder="Группа товаров ID"
                                                                            formControlName="productgroup_id"/>
                                                                </mat-form-field>
                                                                <div class="flex">
                                                                    <mat-form-field 
                                                                    [ngClass]="{slideWidth100: !formBaseInformation.get('by_weight').value,
                                                                                slideWidth50margin8: formBaseInformation.get('by_weight').value}">
                                                                        <mat-slide-toggle formControlName="by_weight">Весовой товар</mat-slide-toggle>
                                                                        <input matInput hidden/>
                                                                    </mat-form-field>
                                                                    <mat-form-field style="width:50%" 
                                                                    [ngClass]="{invisible: !formBaseInformation.get('by_weight').value}">
                                                                        <input   matInput
                                                                                placeholder="Весовой код"
                                                                                matTooltip='Весовой код нельзя изменить. Он генерируется вручную 1 раз, его значение подбирается системой автоматически'
                                                                                formControlName="product_code" [readonly]=true/>
                                                                        <button 
                                                                        mat-button 
                                                                        *ngIf="+formBaseInformation.get('product_code').value==0"
                                                                        matSuffix 
                                                                        mat-icon-button 
                                                                        matTooltip="Генерировать весовой код товара. Весовой код нужен для товаров, которые будут продаваться на развес с напечатанными этикетками." color="primary"
                                                                        (click)="generateProductWeightCode()">
                                                                            <mat-icon>offline_bolt</mat-icon>
                                                                            
                                                                        </button>
                                                                    <mat-progress-bar *ngIf="isWeightCodeGenerating" mode="indeterminate"></mat-progress-bar>
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="flex">
                                                                    <mat-form-field 
                                                                    [ngClass]="{slideWidth100: !formBaseInformation.get('markable').value,
                                                                                slideWidth50margin8: formBaseInformation.get('markable').value}">
                                                                        <mat-slide-toggle formControlName="markable">Маркированый товар</mat-slide-toggle>
                                                                        <input matInput hidden/>
                                                                    </mat-form-field>
                                                                    <mat-form-field  
                                                                    style="width:50%" 
                                                                    [ngClass]="{invisible: !formBaseInformation.get('markable').value}">
                                                                        <mat-label>Группа маркированных товаров</mat-label>
                                                                        <input matInput
                                                                        type="text"
                                                                        formControlName="markable_group_name" 
                                                                        [matAutocomplete]="auto1"
                                                                        (input)="checkEmptyMarkableGroup();"
                                                                        (change)="checkEmptyMarkableGroup();">
                                                                        <mat-autocomplete #auto1="matAutocomplete">
                                                                            <mat-option *ngFor="let option of filteredSpravSysMarkableGroupSet | async" [value]="option.name">
                                                                            <div (click)="formBaseInformation.get('markable_group_id').setValue(option.id)">
                                                                                <span style="margin:10px;">{{option.name}}</span>
                                                                            </div>
                                                                        </mat-option> 
                                                                        </mat-autocomplete>
                                                                    </mat-form-field>
                                                                    <mat-form-field  style="display: none;" >
                                                                        <input   matInput
                                                                                placeholder="Группа маркированных товаров ID"
                                                                                formControlName="markable_group_id"/>
                                                                    </mat-form-field> 
                                                                </div>
                                                                <div class="flex">
                                                                    <mat-form-field 
                                                                        class="slideWidth100">
                                                                        <mat-slide-toggle formControlName="not_buy">Товар не закупается</mat-slide-toggle>
                                                                        <input matInput hidden/>
                                                                    </mat-form-field>
                                                                </div>
                                                                <mat-form-field  style="display: none;" >
                                                                    <input   matInput
                                                                            placeholder="Единица измерения товара ID"
                                                                            formControlName="edizm_id"/>
                                                                </mat-form-field>
                                                                

                                                                
    
                                                                <div class="flex">
                                                                    <div class="flex" style="width:50%; margin-right:5px;">
                                                                        <mat-form-field style="width:70%;">
                                                                            <input  matInput
                                                                                    placeholder="Вес"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="weight"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('weight').touched && formBaseInformation.get('weight').invalid">
                                                                                <i *ngIf="formBaseInformation.get('weight').errors.pattern" class="form-invalid">Неправильный формат. Допускается до 12 цифр в целой и до 3 цифр в дробной части</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field style="width:30%;">
                                                                            <mat-label>Ед.</mat-label>
                                                                            <mat-select  formControlName="weight_edizm_id">                          
                                                                                <mat-option  *ngFor="let rt of spravSysEdizmOfProductWeight" [value]="rt.id">
                                                                                        {{rt.short_name}}
                                                                                </mat-option> 
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="flex" style="width:50%;">
                                                                        <mat-form-field style="width:70%;">
                                                                            <input  matInput
                                                                                    placeholder="Объём"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="volume"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('volume').touched && formBaseInformation.get('volume').invalid">
                                                                                <i *ngIf="formBaseInformation.get('volume').errors.pattern" class="form-invalid">Неправильный формат. Допускается до 12 цифр в целой и до 3 цифр в дробной части</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field style="width:30%;">
                                                                            <mat-label>Ед.</mat-label>
                                                                            <mat-select  formControlName="volume_edizm_id">                          
                                                                                <mat-option  *ngFor="let rt of spravSysEdizmOfProductVolume" [value]="rt.id">
                                                                                        {{rt.short_name}}
                                                                                </mat-option> 
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                </div>
    
                                                                
                                                            </div>    
                                                        </mat-card-content>
                                                    </mat-card>
                                                </div>
                                                <div class="col-lg-4 col-md-12" [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                    <mat-card class="card-block"  [ngClass]="{invisible: (+formBaseInformation.get('ppr_id').value>2) || !(receivedSetsOfFields.length>0)
                                                        }">
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">Поля</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content class="input-form">
                                                            <div class="box-list" >
                                                                <mat-accordion class="example-headers-align">
                                                                    <mat-expansion-panel *ngFor="let set of receivedSetsOfFields">
                                                                        <mat-expansion-panel-header>
                                                                            <mat-panel-title>
                                                                                    {{set.name}}
                                                                            </mat-panel-title>
                                                                        </mat-expansion-panel-header>
                                                                        <div class="box-list">
                                                                            <form [formGroup]="fieldsForm">
                                                                                <div formArrayName="fields">
                                                                                    <div *ngFor="let child of getFieldsFormControls(); let i = index">
                                                                                        <div [formGroupName]="i">
                                                                                            <ng-container *ngIf="dataFields[i]"> 
                                                                                                <div *ngIf="dataFields[i].parent_set_id==set.id">
                                                                                                    <mat-form-field style="width:100%">
                                                                                                        <input  matInput 
                                                                                                                (focus)="filteredProductGroups=[]"
                                                                                                                placeholder={{dataFields[i].name}} 
                                                                                                                aria-label="State" 
                                                                                                                [matAutocomplete]="auto5" 
                                                                                                                formControlName="value"
                                                                                                                (input)="
                                                                                                                fieldIdEditNow=dataFields[i].id;
                                                                                                                fieldIndexEditNow=i;
                                                                                                                canAutocompleteQuery=true;"
                                                                                                                (change)="canAutocompleteQuery=false;"
                                                                                                                >
                                                                                                        <mat-autocomplete #auto5="matAutocomplete">
                                                                                                        <ng-container *ngIf="!isLoading" style="width:320px;">
                                                                                                            <mat-option *ngFor="let group of filteredProductGroups" [value]="group.name">
                                                                                                            <span>{{group.name}}</span>
                                                                                                            </mat-option>
                                                                                                        </ng-container>
                                                                                                        </mat-autocomplete>
                                                                                                    </mat-form-field>
                                                                                                    <mat-progress-bar *ngIf="isLoading && fieldIndexEditNow==i" mode="indeterminate"></mat-progress-bar>
                                                                                                </div>
                                                                                            </ng-container>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </form>                                          
                                                                        </div>
                                                                    </mat-expansion-panel>
                                                                </mat-accordion>
                                                            </div>
                                                        </mat-card-content>
                                                    </mat-card>






















                                                    <mat-card class="card-block">
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">Цены</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content class="input-form">




                                                            <div class="container-fluid" style="padding-right: 0; padding-left: 0;">
                                                                <div class="row" *ngIf="getControlPriceTable().value.length>0" style="margin-right: 0px; margin-left: 0px;">
                                                                    <div class="col-12" style="padding:0px">
                                                                        <!-- <mat-spinner 
                                                                        strokeWidth="3" 
                                                                        class="spinner"
                                                                        [diameter]="44"
                                                                        *ngIf="gettingTableData"
                                                                        ></mat-spinner> -->
                                                                        <table mat-table #_table  [dataSource]="getControlPriceTable().value" 
                                                                        [formGroup]="formBaseInformation" 
                                                                        [trackBy]="trackByIndex" 
                                                                        class="mat-elevation-z8">

                                                                            <ng-container matColumnDef="price_type_id" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef> price_type_id </th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> 
                                                                                    <span>{{row.price_type_id}}</span>
                                                                                </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            <ng-container matColumnDef="price_name" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef>Тип цены</th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> {{row.price_name}} </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            <ng-container matColumnDef="indx" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef>indx</th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> {{i}} </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            <ng-container matColumnDef="row_id" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef> row_id </th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> 
                                                                                    <span>{{row.row_id}}</span>
                                                                                </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            <ng-container matColumnDef="price_value" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef style="width: 70px;">
                                                                                    <span 
                                                                                        style="cursor: default;"
                                                                                        matTooltip="Цена за единицу товара или услуги">
                                                                                        Цена
                                                                                    </span>
                                                                                </th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i" style="min-width: 100px;">
                                                                                    <div style="width:100%;position: relative">
                                                                                        <input  matInput 
                                                                                                class="table-field-editable"
                                                                                                formControlName="price_value"
                                                                                                placeholder=""
                                                                                                (keypress)="numberOnlyPlusDot($event)"
                                                                                                />
                                                                                                <button mat-button 
                                                                                                        type="button"
                                                                                                        (click)="copyPrice(row.price_value);"
                                                                                                        matTooltip='Копировать данное значение цены во все остальные типы цен'
                                                                                                        matSuffix mat-icon-button 
                                                                                                        *ngIf="getControlPriceTable().value.length>0"
                                                                                                        style="padding: 0px;
                                                                                                        min-width: 0px;
                                                                                                        width: 17px;
                                                                                                        height: 17px;
                                                                                                        flex-shrink: 0;
                                                                                                        line-height: 17px;
                                                                                                        border-radius: 50%;
                                                                                                        position: absolute;
                                                                                                        top: -1px;
                                                                                                        right: -18px;
                                                                                                        color: #585858;
                                                                                                        z-index: 1000;">
                                                                                            <mat-icon style="    background-repeat: no-repeat;
                                                                                            display: inline-block;
                                                                                            fill: currentColor;
                                                                                            /* height: 6px; */
                                                                                            margin: -3.5px 0px 0-2px;
                                                                                            width: 14px;
                                                                                            font-size: 16px;">content_copy</mat-icon>
                                                                                        </button>
                                                                                        <mat-hint align="start" >
                                                                                            <i *ngIf="getControlPriceTable().controls[i].get('price_value').invalid && getControlPriceTable().controls[i].get('price_value').errors.pattern" class="table-form-invalid">Неправильный формат. Допускается до 7 цифр в целой и до 2 цифр в дробной части</i>
                                                                                        </mat-hint>
                                                                                    </div>
                                                                                </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            
                                                                            <tr mat-header-row *matHeaderRowDef="pricesDisplayedColumns"></tr>
                                                                            <tr mat-row *matRowDef="let row; columns: pricesDisplayedColumns;"></tr>
                                                                            <!-- <tr mat-footer-row *matFooterRowDef="pricesDisplayedColumns"></tr> -->
                                                                        </table>
                                                                    </div>  
                                                                </div>  
                                                                <div  *ngIf="getControlPriceTable().value.length>0" class="col-12 center-align" style="margin-top: 20px;">
                                                                    
                                                                </div>
                                                            </div>





                                                        </mat-card-content>
                                                    </mat-card>


















                                                    <mat-card class="card-block"> 
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">Поставщики</mat-card-title>
                                                        </mat-card-header>
                                                        <div class="box-list" cdkDropList (cdkDropListDropped)="dropCagent($event)">
                                                            <ng-container *ngFor="let cagent of cagentsInfo">
                                                                <div class="field-box-drag" cdkDrag style="cursor:move;">
                                                                    <div style="display: table; width: 100%">
                                                                        <div class="img-wrapper" style="cursor:move; ">
                                                                            <div class="vertical-center">{{cagent.name}}</div><p *cdkDragPreview></p>
                                                                        </div>
                                                                    </div>
                                                                    <div style="width:110px; min-width:110px;">
                                                                        <!-- <a class="inactive" [routerLink]="['../../cagentsdoc', cagent.cagent_id ]">
                                                                            <mat-icon matTooltip="Открыть карточку поставщика">launch</mat-icon>
                                                                        </a> -->
                                                                        <mat-icon matTooltip="Открыть карточку поставщика" class="icon" (click)="openCagentCard(cagent.cagent_id)">launch</mat-icon>
                                                                        <mat-icon matTooltip="Свойства поставщика" class="icon" (click)="clickBtnEditCagentProperties(cagent.cagent_id, cagent.cagent_article, cagent.additional)">assignment</mat-icon>
                                                                        <mat-icon matTooltip="Удалить поставщика" class="icon" (click)="clickBtnDeleteCagent(cagent.cagent_id)">delete_forever</mat-icon>
                                                                    </div>
                                                                </div>
                                                            </ng-container>
                                                        </div>
                                                        <div class="div-100" [style.display]="visBtnUpdate==true?'block':'none'"> 
                                                            <div class="center" style="width:100%; height: 38px;">
                                                                <button matTooltip="Добавить поставщиков" [ngClass]="{invisible: visBeforeCreatingBlocks}" mat-mini-fab color="primary" (click)="openDialogAddCagents()">
                                                                    <mat-icon>add</mat-icon>
                                                                </button>
                                                            </div>
                                                        </div> 
                                                    </mat-card>
                                                    <mat-card class="card-block"> 
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">Штрих-коды</mat-card-title>
                                                        </mat-card-header>
                                                        <div>
                                                            <ng-container *ngFor="let barcode of barcodesInfo">
                                                                <div class="field-box-drag">
                                                                    <div style="display: table; width: 100%; cursor:default">
                                                                        <div class="img-wrapper">
                                                                            <div class="vertical-center"  matTooltip="{{barcode.value}}">
                                                                                <span>{{barcode.name}}</span>
                                                                                <span *ngIf="barcode.description!=''">&nbsp;({{barcode.description}})</span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- barcode.id - это primary key таблицы product_barcodes -->
                                                                    <div style="width:75px; min-width:75px;">
                                                                        <mat-icon matTooltip="Редактировать" class="icon" 
                                                                        (click)="clickBtnEditBarcodeProperties(
                                                                            barcode.id,
                                                                            barcode.barcode_id,
                                                                            barcode.value, 
                                                                            barcode.description,
                                                                            barcode.name)">assignment</mat-icon>
                                                                        <mat-icon matTooltip="Удалить штрих-код" class="icon" (click)="clickBtnDeleteBarcode(barcode.id)">delete_forever</mat-icon>
                                                                    </div>
                                                                </div>
                                                            </ng-container>
                                                        </div>
                                                        <div class="div-100" [style.display]="visBtnUpdate==true?'block':'none'"> 
                                                            <div class="center" style="width:100%; height: 38px;">
                                                                <button matTooltip="Добавить штрих-код" [ngClass]="{invisible: visBeforeCreatingBlocks}" mat-mini-fab color="primary" (click)="openDialogAddBarcodes()">
                                                                    <mat-icon>add</mat-icon>
                                                                </button>
                                                            </div>
                                                        </div> 
                                                    </mat-card>
                                                </div>
                                                <div class="col-lg-4 col-md-12"  [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                    <mat-card class="card-block">
                                                        
                                                            <mat-card-header>
                                                                <mat-card-title class="card-title">Изображения</mat-card-title>
                                                            </mat-card-header>

                                                            <div class="div-foto hand"> 
                                                            <img *ngIf="imagesInfo.length==0" matTooltip="Для данного товара изображений нет" class="img" src="{{noImageAddress}}" width=100%>
                                                            <img *ngIf="imagesInfo.length>0" matTooltip="Посмотреть изображение" class="img" (click)="showMainImage()" [src]="imageToShow" width=100%>
                                                            </div> 
                                                        <div class="box-list" cdkDropList (cdkDropListDropped)="dropImage($event)">
                                                            <ng-container *ngFor="let i of imagesInfo">
                                                                <div class="field-box-drag" cdkDrag style="cursor:move;">
                                                                    <div matTooltip="Посмотреть изображение" class="img-wrapper" style="cursor:move; ">
                                                                        <img (click)="showImage(i.name)" [src]="i.image" class="thumb_image hand"><p *cdkDragPreview></p>
                                                                    </div>
                                                                    <div style="width:50px; min-width:70px;">
                                                                        <mat-icon  matTooltip='Открыть карточку файла' (click)="openFileCard(i.id)" class="icon" >launch</mat-icon>
                                                                        <mat-icon matTooltip="Удалить изображение" class="icon" (click)="clickBtnDeleteImage(i.id)">delete_forever</mat-icon>
                                                                    </div>
                                                                </div>
                                                            </ng-container>
                                                        </div>
                                                        <div class="div-100" [style.display]="visBtnUpdate==true?'block':'none'"> 
                                                            <div class="center" style="width:100%; height: 38px;">
                                                                <button matTooltip="Добавить изображения" [ngClass]="{invisible: visBeforeCreatingBlocks}" mat-mini-fab color="primary" (click)="openDialogAddImages()" matTooltip="Загрузить картинку для товара.">
                                                                    <mat-icon>add</mat-icon>
                                                                </button>
                                                            </div>
                                                        </div> 

                                                    </mat-card>
                                                </div> 
                                            </div>
                                        </div>   
                                </mat-tab>

                                <mat-tab  *ngIf="visAfterCreatingBlocks"  label="Операции">
                                    
                                    <mat-card class="card">
                                        <mat-card-content>
                                            <div class="card  w-100">
                                                <div class="card-body">
                                                        <div class="flex" style="display:none">
                                                            <div class="form-group">
                                                                <label class="control-label col-sm-2" for="offset">offset</label>
                                                                <input [(ngModel)]="formProductHistory.offset" 
                                                                value="" 
                                                                type="text" 
                                                                class="form-control" 
                                                                id="offset" 
                                                                name="offSet"
                                                                [ngModelOptions]="{standalone: true}">
                                                            </div>
                                    
                                                            <div class="form-group">
                                                                <label class="control-label col-sm-2" for="SortColumn">SortColumn</label>
                                                                <input [(ngModel)]="formProductHistory.sortColumn" 
                                                                type="text" 
                                                                class="form-control" 
                                                                id="SortColumn" 
                                                                name="SortColumn" 
                                                                value=""
                                                                [ngModelOptions]="{standalone: true}">
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="control-label col-sm-2" for="SortAsc">SortAsc</label>
                                                                <input [(ngModel)]="formProductHistory.sortAsc" 
                                                                type="text" 
                                                                class="form-control" 
                                                                id="SortAsc" 
                                                                name="SortAsc" 
                                                                value=""
                                                                [ngModelOptions]="{standalone: true}">
                                                            </div>
                                                        </div> 
                                                        <div class="flex">
                                                            <mat-form-field style="width:50px;" class="num-of-rows">
                                                                <mat-label>Строк</mat-label>
                                                                <mat-select [(value)]="formProductHistory.result" (selectionChange)="setNumOfPages()" class="form-control" id="selectRowsPerPage" name="result">                           
                                                                    <mat-option  *ngFor="let num of numRows" [value]="num.value">
                                                                            {{num.viewValue}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                            <mat-form-field  style="margin-left: 10px">
                                                                <mat-label>Предприятие</mat-label>
                                                                <mat-select  [(value)]="formProductHistory.companyId" (selectionChange)="getTable()">                          
                                                                    <mat-option  *ngFor="let rt of receivedCompaniesListForHistoryReport" [value]="rt.id">
                                                                            {{rt.name}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                            <mat-form-field style="margin-left: 10px">
                                                                <mat-label>Отделение</mat-label>
                                                                <mat-select  [(value)]="formProductHistory.departmentId" (selectionChange)="getTable()">
                                                                    <mat-option *ngIf="receivedMyDepartmentsList && receivedMyDepartmentsList.length>1" value="0" selected>Все доступные отделения</mat-option>                          
                                                                    <mat-option  *ngFor="let rdl of receivedMyDepartmentsList" [value]="rdl.id">
                                                                            {{rdl.name}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                                                                                            
                                                            <mat-form-field style="margin-left: 10px; width: 100px;">
                                                                <input  matInput 
                                                                        placeholder="С даты"
                                                                        [matDatepicker]="dpFrom"
                                                                        [(ngModel)]="formProductHistory.dateFrom"
                                                                        (dateChange)="addEvent('dateFrom', $event)"
                                                                        [ngModelOptions]="{standalone: true}"
                                                                        />
                                                                        <mat-datepicker-toggle matSuffix [for]="dpFrom"></mat-datepicker-toggle>
                                                                <mat-datepicker #dpFrom></mat-datepicker>
                                                            </mat-form-field>
                                    
                                                            <mat-form-field style="margin-left: 10px; width: 100px;">
                                                                <input  matInput 
                                                                        placeholder="По дату"
                                                                        [matDatepicker]="dpTo"
                                                                        [(ngModel)]="formProductHistory.dateTo"
                                                                        (dateChange)="addEvent('dateTo', $event)"
                                                                        [ngModelOptions]="{standalone: true}"
                                                                        />
                                                                        <mat-datepicker-toggle matSuffix [for]="dpTo"></mat-datepicker-toggle>
                                                                <mat-datepicker #dpTo></mat-datepicker>
                                                            </mat-form-field>
                                                            <span  class="emptyspace"></span>
                                                            <button mat-button
                                                                    style="margin-left: 10px" 
                                                                    [matMenuTriggerFor]="oper"
                                                                    type="button"
                                                                    matTooltip='Выбрать операции'
                                                                    matSuffix mat-icon-button>
                                                                    <mat-icon>list_alt</mat-icon>
                                                                    </button>
                                                                    <mat-menu #oper="matMenu" xPosition="before">
                                                                        <div style="width: 250px;">
                                                                            <ul>
                                                                                <li *ngFor="let row of documentsIds">
                                                                                        <mat-checkbox
                                                                                        (click)="$event.stopPropagation()"
                                                                                        (change)="$event ? clickDocumentCheckbox(row) : null"
                                                                                        [checked]="selection.isSelected(row)"
                                                                                        >{{row.name}}</mat-checkbox>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                    </mat-menu>
                                                            <button mat-button 
                                                                matTooltip='Показать историю по операциям с товаром'
                                                                (click)="getTable()"  
                                                                type="submit"
                                                                matSuffix mat-icon-button>
                                                                <mat-icon>search</mat-icon>
                                                            </button>
                                                        </div>
                                                        <div id="result_form">
                                                            <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
                                                                <ng-container matColumnDef="department">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Наименование торгового отделения или склада">
                                                                    <span (click)="setSort('department')" class="sortheader"> Отделение 
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='department'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='department'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.department}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="docName">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Наименование торговой операции">
                                                                    <span (click)="setSort('docName')" class="sortheader"> Операция 
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='docName'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='docName'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.docName}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="change">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Изменение товара в данной операции">
                                                                    <span (click)="setSort('change')" class="sortheader"> Изменение 
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='change'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='change'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.change}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="quantity">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Количество товара в данной операции">
                                                                    <span (click)="setSort('quantity')" class="sortheader"> Количество 
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='quantity'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='quantity'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.quantity}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="date_time_created">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Дата и время совершенной операции, применительно к Вашему часосвому поясу">
                                                                    <span (click)="setSort('date_time_created_sort')" class="sortheader">  Дата операции  
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='date_time_created_sort'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='date_time_created_sort'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.date_time_created}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="last_operation_price">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Цена, применённая в соответствующей операции">
                                                                    <span (click)="setSort('last_operation_price')" class="sortheader"> Цена операции 
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='last_operation_price'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='last_operation_price'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.last_operation_price}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="last_purchase_price">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Цена, по которой товар поступил на склад в последней операции приёмки или оприходования">
                                                                    <span (click)="setSort('last_purchase_price')" class="sortheader"> Последняя цена<br>получения 
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='last_purchase_price'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='last_purchase_price'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.last_purchase_price}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="avg_purchase_price">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Средняя цена, по которой товар поступал на склад. Рассчитывается исходя из цен поступления товара и остатков от предыдущих поступлений.">
                                                                    <span (click)="setSort('avg_purchase_price')" class="sortheader"> Средняя цена<br>получения
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='avg_purchase_price'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='avg_purchase_price'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.avg_purchase_price}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="avg_netcost_price">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Средняя себестоимость товара, учитывающая его цену при поступлении на склад и расходы на доставку">
                                                                    <span (click)="setSort('avg_netcost_price')" class="sortheader"> Средняя<br>себестоимость 
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='avg_netcost_price'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='avg_netcost_price'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.avg_netcost_price}} </td>
                                                                </ng-container>
                                                                
                                                                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                                            </table>
                                                        </div>
                                                    <!-- </form> -->
                                                </div> 
                                            </div>  
                                        </mat-card-content>
                                    </mat-card>
                                </mat-tab>

                                <mat-tab  *ngIf="visAfterCreatingBlocks"  label="О документе">
                                    <form [formGroup]="formAboutDocument">
                                        <mat-card style="margin:10px;">
                                            <mat-card-content class="input-form">
                                                    <mat-form-field [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                        <input  matInput
                                                                placeholder="Предприятие"
                                                                formControlName="company" [readonly]=true/>
                                                    </mat-form-field>
                                                    <mat-form-field [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                        <input  matInput
                                                                placeholder="Создатель"
                                                                formControlName="creator" [readonly]=true/>
                                                    </mat-form-field>
                                                    <mat-form-field [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                        <input  matInput
                                                                placeholder="Дата создания"
                                                                formControlName="date_time_created" [readonly]=true/>
                                                    </mat-form-field>
                                                    <mat-form-field [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                        <input  matInput
                                                                placeholder="Изменение"
                                                                formControlName="changer" [readonly]=true/>
                                                    </mat-form-field>
                                                    <mat-form-field [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                        <input  matInput
                                                                placeholder="Дата изменения"
                                                                formControlName="date_time_changed" [readonly]=true/>
                                                    </mat-form-field>
                                            </mat-card-content>
                                        </mat-card>  
                                    </form>  
                                </mat-tab>

                        </mat-tab-group>

                </form>
            </mat-card-content> 
        </mat-card>
    </div>
</mat-drawer-container>